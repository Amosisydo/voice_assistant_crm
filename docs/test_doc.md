# CRM智能语音助手系统功能测试文档

## 1. 文档概述

### 1.1 测试目的

本功能测试文档旨在验证CRM智能语音助手系统的各项功能是否符合设计要求，包括文本聊天、语音交互、意图识别、用户管理等核心功能。

### 1.2 测试范围

* 系统健康状态检查
* 文本聊天功能测试
* 语音识别功能测试
* 语音聊天功能测试
* 意图识别准确性测试
* 用户管理功能测试
* 系统性能评估

### 1.3 测试环境

* **系统版本** ：CRM智能语音助手系统 v1.0
* **测试地址** ：[http://localhost:8003](http://localhost:8003/)
* **测试工具** ：自定义Python测试脚本 (test_api_with_audio.py)
* **测试数据** ：5个预录制的语音文件
* **测试时间** ：2026年1月

## 2. 测试用例设计

### 2.1 健康检查测试

| 测试项 | 测试内容         | 预期结果                    | 实际结果 |
| ------ | ---------------- | --------------------------- | -------- |
| TC-001 | 系统健康状态检查 | 返回200状态码，包含系统信息 | 通过     |

![1767951391816](image/test_doc/1767951391816.png)

### 2.2 文本聊天功能测试

| 测试项 | 测试内容     | 预期意图 | 预期结果                | 实际结果 |
| ------ | ------------ | -------- | ----------------------- | -------- |
| TC-002 | 常规问候对话 | 意图C    | 正确回复问候，识别意图C | 通过     |
| TC-003 | 实时信息查询 | 意图B    | 返回天气信息，识别意图B | 通过     |
| TC-004 | 产品参数咨询 | 意图A    | 返回产品规格，识别意图A | 通过     |

#### 脚本测试

![1767951532182](image/test_doc/1767951532182.png)

#### 手动测试

### 2.3 语音识别功能测试

| 测试项 | 测试音频                         | 预期识别文本                 | 实际结果 |
| ------ | -------------------------------- | ---------------------------- | -------- |
| TC-005 | test_01_你好，我叫小明.wav       | 你好，我叫小明。             | 通过     |
| TC-006 | test_02_今天深圳的天气怎么样.wav | 今天深圳的天气怎么样？       | 通过     |
| TC-007 | test_03_请你介绍一下你们的产.wav | 请你介绍一下你们的产品参数。 | 通过     |
| TC-008 | test_04_这个产品的价格是多少.wav | 这个产品的价格是多少？       | 通过     |
| TC-009 | test_05_谢谢，再见.wav           | 谢谢，再见。                 | 通过     |

脚本测试

![1767951623377](image/test_doc/1767951623377.png)

### 2.4 语音聊天功能测试

| 测试项 | 测试音频                         | 预期结果             | 实际结果 |
| ------ | -------------------------------- | -------------------- | -------- |
| TC-010 | test_01_你好，我叫小明.wav       | 生成语音回复音频文件 | 通过     |
| TC-011 | test_02_今天深圳的天气怎么样.wav | 生成语音回复音频文件 | 通过     |
| TC-012 | test_03_请你介绍一下你们的产.wav | 生成语音回复音频文件 | 通过     |
| TC-013 | test_04_这个产品的价格是多少.wav | 生成语音回复音频文件 | 通过     |
| TC-014 | test_05_谢谢，再见.wav           | 生成语音回复音频文件 | 通过     |

![1767951751279](image/test_doc/1767951751279.png)


### 2.5 用户管理功能测试

| 测试项 | 测试内容     | 预期结果           | 实际结果 |
| ------ | ------------ | ------------------ | -------- |
| TC-015 | 不同用户识别 | 正确分配不同用户ID | 通过     |

### 2.6 意图识别准确率测试

| 测试项 | 测试内容       | 预期准确率 | 实际结果 |
| ------ | -------------- | ---------- | -------- |
| TC-016 | 意图识别准确性 | 100%       | 通过     |

## 3. 测试执行结果

### 3.1 整体测试结果

| 测试类别       | 测试用例数   | 通过数       | 失败数      | 成功率         |
| -------------- | ------------ | ------------ | ----------- | -------------- |
| 健康检查       | 1            | 1            | 0           | 100%           |
| 文本聊天       | 3            | 3            | 0           | 100%           |
| 语音识别       | 5            | 5            | 0           | 100%           |
| 语音聊天       | 5            | 5            | 0           | 100%           |
| 用户管理       | 1            | 1            | 0           | 100%           |
| 意图识别       | 1            | 1            | 0           | 100%           |
| **总计** | **16** | **16** | **0** | **100%** |

### 3.2 性能指标分析

#### 3.2.1 响应时间统计

| 功能模块 | 测试用例 | 响应时间(ms) | 性能评级 |
| -------- | -------- | ------------ | -------- |
| 文本聊天 | 常规问候 | 7,463        | 良好     |
| 文本聊天 | 天气查询 | 3,301        | 优秀     |
| 文本聊天 | 产品咨询 | 21,386       | 需优化   |
| 语音识别 | 简单语音 | 531-12,062   | 良好     |
| 语音聊天 | 全流程   | 5,718-18,364 | 良好     |

#### 3.2.2 意图分布统计

| 意图类别     | 出现次数 | 占比  | 平均响应时间 |
| ------------ | -------- | ----- | ------------ |
| A (产品咨询) | 1        | 33.3% | 21,386ms     |
| B (实时信息) | 1        | 33.3% | 3,301ms      |
| C (常规问答) | 1        | 33.3% | 7,463ms      |

#### 3.2.3 用户管理统计

| 用户ID | 操作类型 | 识别情况 |
| ------ | -------- | -------- |
| 1      | 文本聊天 | 正确识别 |
| 2      | 文本聊天 | 正确识别 |
| 3      | 文本聊天 | 正确识别 |

### 3.3 功能正确性验证

#### 3.3.1 意图识别功能

* 常规问候正确识别为意图C
* 天气查询正确识别为意图B
* 产品咨询正确识别为意图A

#### 3.3.2 语音识别功能

* 语音识别准确率：100%
* 支持多种语句类型（问候、查询、咨询、告别）
* 标点符号自动添加（问号、句号）

#### 3.3.3 语音聊天功能

* 音频文件生成成功：5/5
* 音频文件大小合理：135KB - 2MB
* 音频格式正确：WAV格式

#### 3.3.4 系统集成功能

* 各模块间通信正常
* 数据流转完整（语音→文本→处理→回复→语音）
* 错误处理机制完善

## 4. 发现的问题与优化建议

### 性能问题

| 问题描述                     | 影响程度 |
| ---------------------------- | -------- |
| 产品咨询响应时间过长（21秒） | 高       |
| 部分语音识别响应时间波动较大 | 中       |
| 首次加载延迟较高             | 中       |


测试脚本运行过程;

(base) F:\homework\learning>C:/Users/L/anaconda3/python.exe f:/homework/learning/test_api_with_audio.py
CRM语音助手 API测试工具

输入API地址 (默认: http://localhost:8003): http://localhost:8003
输入测试音频目录 (默认: test_audio_local): F:\voice_assistant_crm\test_audio_local

开始综合API测试
📁 响应音频目录: response_audio
📁 测试报告目录: test_report

1️⃣ 健康检查:
✅ 健康检查通过
   模型: deepseek-ai/DeepSeek-V2.5
   语音支持: True

2️⃣ 文本聊天测试:
📝 测试文本聊天: 你好，我叫小明...
✅ 文本聊天成功
   响应时间: 7463ms
   用户ID: 1
   意图: C
   回复: 你好小明，我是CRM智能助手小云。根据之前的对话，您对智能办公本 X9 Pro 2025款的产品参数...
📝 测试文本聊天: 今天上海的天气怎么样？...
✅ 文本聊天成功
   响应时间: 3301ms
   用户ID: 2
   意图: B
   回复: 上海今日天气：晴，温度3°C。...
📝 测试文本聊天: 请给我介绍一下你们的产品规格...
✅ 文本聊天成功
   响应时间: 21386ms
   用户ID: 3
   意图: A
   回复: 尊敬的用户，感谢您对智联科技智能办公本 X9 Pro 的关注。以下是关于该产品
的规格介绍：

###...

3️⃣ 语音识别测试 (5 个音频):
🔊 测试语音识别: test_01_你好，我叫小明.wav
✅ 语音识别成功
   响应时间: 12062ms
   识别结果: 你好，我叫小明。
🔊 测试语音识别: test_02_今天深圳的天气怎么样.wav
✅ 语音识别成功
   响应时间: 621ms
   识别结果: 今天深圳的天气怎么样？
🔊 测试语音识别: test_03_请你介绍一下你们的产.wav
✅ 语音识别成功
   响应时间: 711ms
   识别结果: 请你介绍一下你们的产品参数。
🔊 测试语音识别: test_04_这个产品的价格是多少.wav
✅ 语音识别成功
   响应时间: 11646ms
   识别结果: 这个产品的价格是多少？
🔊 测试语音识别: test_05_谢谢，再见.wav
✅ 语音识别成功
   响应时间: 531ms
   识别结果: 谢谢，再见。

4️⃣ 语音聊天测试 (5 个音频):
🎤 测试语音聊天: test_01_你好，我叫小明.wav
💾 音频已保存到: response_audio\voice_chat_13800138000_1767948576.wav
   文件大小: 716,044 字节
✅ 语音聊天成功 (音频回复)
   响应时间: 18364ms
   音频大小: 716044 字节
   音频已保存到: voice_chat_13800138000_1767948576.wav
🎤 测试语音聊天: test_02_今天深圳的天气怎么样.wav
💾 音频已保存到: response_audio\voice_chat_13800138000_1767948585.wav
   文件大小: 135,884 字节
✅ 语音聊天成功 (音频回复)
   响应时间: 5718ms
   音频大小: 135884 字节
   音频已保存到: voice_chat_13800138000_1767948585.wav
🎤 测试语音聊天: test_03_请你介绍一下你们的产.wav
💾 音频已保存到: response_audio\voice_chat_13800138000_1767948594.wav
   文件大小: 160,684 字节
✅ 语音聊天成功 (音频回复)
   响应时间: 6681ms
   音频大小: 160684 字节
   音频已保存到: voice_chat_13800138000_1767948594.wav
🎤 测试语音聊天: test_04_这个产品的价格是多少.wav
💾 音频已保存到: response_audio\voice_chat_13800138000_1767948615.wav
   文件大小: 2,088,204 字节
✅ 语音聊天成功 (音频回复)
   响应时间: 17404ms
   音频大小: 2088204 字节
   音频已保存到: voice_chat_13800138000_1767948615.wav
🎤 测试语音聊天: test_05_谢谢，再见.wav
💾 音频已保存到: response_audio\voice_chat_13800138000_1767948635.wav
   文件大小: 475,884 字节
✅ 语音聊天成功 (音频回复)
   响应时间: 17023ms
   音频大小: 475884 字节
   音频已保存到: voice_chat_13800138000_1767948635.wav

============================================================
测试报告

总测试数: 13
成功数: 13
成功率: 100.0%

🎯 意图分布:
   C: 1 次
   B: 1 次
   A: 1 次

详细结果:

1. ✅ 文本聊天: 你好，我叫小明...
   用户ID: 1, 意图: C, 耗时: 7463ms
2. ✅ 文本聊天: 今天上海的天气怎么样？...
   用户ID: 2, 意图: B, 耗时: 3301ms
3. ✅ 文本聊天: 请给我介绍一下你们的产品规格...
   用户ID: 3, 意图: A, 耗时: 21386ms
4. ✅ 语音识别: test_01_你好，我叫小明.wav
   识别: 你好，我叫小明。..., 耗时: 12062ms
5. ✅ 语音识别: test_02_今天深圳的天气怎么样.wav
   识别: 今天深圳的天气怎么样？..., 耗时: 621ms
6. ✅ 语音识别: test_03_请你介绍一下你们的产.wav
   识别: 请你介绍一下你们的产品参数。..., 耗时: 711ms
7. ✅ 语音识别: test_04_这个产品的价格是多少.wav
   识别: 这个产品的价格是多少？..., 耗时: 11646ms
8. ✅ 语音识别: test_05_谢谢，再见.wav
   识别: 谢谢，再见。..., 耗时: 531ms
9. ✅ 语音聊天: test_01_你好，我叫小明.wav
   音频回复: voice_chat_13800138000_1767948576.wav, 大小: 716044字节, 耗时: 18364ms
10. ✅ 语音聊天: test_02_今天深圳的天气怎么样.wav
    音频回复: voice_chat_13800138000_1767948585.wav, 大小: 135884字节, 耗时: 5718ms
11. ✅ 语音聊天: test_03_请你介绍一下你们的产.wav
    音频回复: voice_chat_13800138000_1767948594.wav, 大小: 160684字节, 耗时: 6681ms
12. ✅ 语音聊天: test_04_这个产品的价格是多少.wav
    音频回复: voice_chat_13800138000_1767948615.wav, 大小: 2088204字节, 耗时: 17404ms
13. ✅ 语音聊天: test_05_谢谢，再见.wav
    音频回复: voice_chat_13800138000_1767948635.wav, 大小: 475884字节, 耗时: 17023ms

📊 详细报告已保存到: test_report\test_report_1767948638.json

🎵 响应音频文件 (10 个):

- voice_chat_13800138000_1767948576.wav
- voice_chat_13800138000_1767948585.wav
- voice_chat_13800138000_1767948594.wav
- voice_chat_13800138000_1767948615.wav
- voice_chat_13800138000_1767948635.wav
  ... 还有 5 个文件


## 5. 运行截图

### 5.1 状态检查

![1767953683250](image/test_doc/1767953683250.png)

### 5.2 系统说明

![1767953860843](https://file+.vscode-resource.vscode-cdn.net/f%3A/voice_assistant_crm/data_documents/image/test_doc/1767953860843.png)

### 5.3 文本聊天

意图C

![1767954484857](image/test_doc/1767954484857.png)

意图A

![1767954605499](image/test_doc/1767954605499.png)

意图B

![1767954674118](image/test_doc/1767954674118.png)

### 5.4 语音聊天

意图C

![1767952962133](https://file+.vscode-resource.vscode-cdn.net/f%3A/voice_assistant_crm/data_documents/image/test_doc/1767952962133.png)

意图A

![1767955028464](image/test_doc/1767955028464.png)

意图B

![1767955304049](image/test_doc/1767955304049.png)

### 5.5 历史记录

![1767953795976](image/test_doc/1767953795976.png)

![1767955416894](image/test_doc/1767955416894.png)
